---
title: ä¸‰æ¬¡æ ·æ¡æ’å€¼æ³•&ç‰›é¡¿æ’å€¼æ³• MATLABå®žçŽ° æ•°å€¼åˆ†æž - è§‚å¯Ÿé¾™æ ¼çŽ°è±¡
hide: false
math: true
category:
  - Math
  - æ•°å€¼åˆ†æž
tags:
  - æ’å€¼æ³•
abbrlink: 63175
date: 2022-03-19 13:03:09
index_img:
banner_img:
---

è¿™æ¬¡æ•°å€¼åˆ†æžçš„å¤§ä½œä¸šè¦æ±‚æ˜¯â€œè§‚å¯Ÿé¾™æ ¼çŽ°è±¡â€ï¼Œåˆ©ç”¨Newtonè¿­ä»£æ³•å’Œä¸‰æ¬¡æ ·æ¡æ’å€¼æ³•åšå¯¹æ¯”ï¼Œä½“çŽ°å‡ºé«˜æ¬¡æ’å€¼å¤šé¡¹å¼åœ¨è·ç¦»è¾ƒè¿œçš„åœ°æ–¹ä¼šæœ‰æ˜Žæ˜¾çš„â€œéœ‡è¡â€ï¼Œè€Œåˆ†æ®µä½Žæ¬¡æ’å€¼å°±ä¸ä¼šæœ‰è¿™ç§é—®é¢˜ï¼Œç”±äºŽæœ¬æ¬¡ä½œä¸šæ˜¯ç”¨Latexå†™çš„ä¸æƒ³å†å†™ä¸€æ¬¡Markdownç½‘é¡µç‰ˆäº†ï¼ˆæ‡’~

æ‰€ä»¥å°±ç›´æŽ¥ç»™å‡ºè¿™æ¬¡ç®—æ³•çš„pdfç‰ˆï¼Œé‡Œé¢å¯¹è®¡ç®—è¿‡ç¨‹è½¬åŒ–æœ‰éžå¸¸è¯¦ç»†è§£é‡Šï¼Œå®Œæ•´çš„MATLABä»£ç åœ¨é™„å½•ä¸­ä¹Ÿæœ‰ç»™å‡ºï¼Œè¿™é‡Œå†è´´ä¸€éðŸ˜„ï¼ˆæˆ‘çš„MATLABè„šæœ¬ä¹ æƒ¯å–œæ¬¢ç”¨mainå‡½æ•°ï¼Œå°±æ˜¯ç¨‹åºé»˜è®¤å…ˆæ‰§è¡Œçš„å‡½æ•°ï¼Œè¿™æ ·å’ŒCè¯­è¨€å¾ˆç›¸ä¼¼ï¼Œçœ‹å¾—æ›´åŠ æ¸…æ¥š~ï¼‰

å¦‚æžœæ‰“ä¸å¼€æ’ä»¶å¯ä»¥æ¢ä¸ªæµè§ˆå™¨è¯•è¯•~ï¼ˆæ‰‹æœºæµè§ˆå™¨æ˜¯æ— æ³•åœ¨çº¿é¢„è§ˆçš„ï¼Œåªèƒ½ä¸‹è½½ä¸‹æ¥çœ‹ðŸ˜£ï¼‰

[pdfä¸‹è½½é“¾æŽ¥](/file/Spline_Newton.pdf)

{% pdf /file/Spline_Newton.pdf pdf %}

é™„ä¸Šå®Œæ•´MATLABä»£ç 

```matlab
function main
    format short
    a = -1;
    b = 1;
    x = (a:0.01:b)';
    plot(x, f(x), 'r', 'linewidth', 1); % f(x)å›¾åƒ
    hold on
    % Newtonæ’å€¼æ³•æ±‚N5,N10
    xx = (a:2/5:b)';
    y = Newton(xx, f(xx));
    class(y)
    disp("N5 = ")
    disp(y) % è¾“å‡ºN5æ’å€¼ç»“æžœ
    plot(x, subs(y, x), 'color', '#43A047', 'linewidth', 1); % N5å›¾åƒ
    hold on
    xx = (a:2/10:b)';
    y = Newton(xx, f(xx));
    disp("N10 = ")
    disp(y) % è¾“å‡ºN10æ’å€¼ç»“æžœ
    plot(x, subs(y, x), 'linewidth', 1); % N10å›¾åƒ
    hold on
    % ä¸‰æ¬¡æ ·æ¡æ’å€¼
    xx = (a:2/10:b)';
    y = mySpline(xx, f(xx), fff(a), fff(b));
    disp("S10 = ")
    disp(y)
    for i = 1 : 10
        l = xx(i);
        r = l + 2/10;
        x = l:0.01:r;
        plot(x, subs(y(i), x), 'b', 'linewidth', 1) % S10å›¾åƒ
        hold on
    end
    legend(["f(x)" "N5" "N10" "S10"]);
    set(gca, 'FontName', 'Times New Roman', 'FontSize', 16);
end

function y = f(x)
    y = 1 ./ (1 + 25 * x .* x);
end
function y = fff(x)
    y = 50 * (75*x.*x-1) ./ (1+25*x.*x)^3;
end

% Newtonæ’å€¼æ³•,aä¸ºæ’å€¼ç‚¹åˆ—å‘é‡,bä¸ºæ’å€¼ç‚¹å¯¹åº”çš„å‡½æ•°å€¼åˆ—å‘é‡
function N = Newton(a, b)
    [n, ~] = size(a);
    diff = zeros(n, n); % åˆå§‹åŒ–å·®å•†è¡¨
    diff(1, :) = b';
    syms x % å®šä¹‰å‚æ•°x
    now = 1; % å¯¹åº”ä¸Šæ–‡ä¸­çš„ pi(x)
    N = diff(1, 1);
    % é€’æŽ¨è®¡ç®—å·®å•†è¡¨ï¼Œå¹¶åŒæ—¶è®¡ç®—å‡ºæ’å€¼å¤šé¡¹å¼N(x)
    for i = 2 : n
        for j = i : n
            diff(i, j) = (diff(i-1, j)-diff(i-1, j-1)) / (a(j) - a(j-i+1));
        end
        now = now * (x-a(i-1));
        N = N + diff(i, i) * now;
    end
    N = expand(N); % å±•å¼€æ’å€¼å¤šé¡¹å¼
    N = vpa(N, 5); % å°†åˆ†å¼ç³»æ•°è½¬åŒ–ä¸ºå°æ•°ç³»æ•°
end

% ä¸‰æ¬¡æ ·æ¡æ’å€¼æ³•
% aä¸ºä¼ å…¥çš„æ’å€¼ç‚¹æž„æˆçš„å‘é‡,bä¸ºæ’å€¼ç‚¹å¯¹åº”å‡½æ•°å€¼æž„æˆçš„å‘é‡,M1,Mnä¸ºè¾¹ç•Œæ¡ä»¶
function S = mySpline(a, b, M1, Mn)
    [n, ~] = size(a);
    % å‘é‡å®šä¹‰
    h = a(2:n) - a(1:n-1); % æ±‚è§£å‘é‡h
    mu = h(1:n-2) ./ (h(1:n-2) + h(2:n-1)); % æ±‚è§£å‘é‡mu
    la = 1 - mu; % æ±‚è§£å‘é‡lambda
    h1 = h(1:n-2); % å®šä¹‰ä¸­é—´å˜é‡h1
    h2 = h(2:n-1); % å®šä¹‰ä¸­é—´å˜é‡h2
    % æ±‚è§£å‘é‡d
    d = 6*((b(3:n)-b(2:n-1))./h2-(b(2:n-1)-b(1:n-2))./h1)./(h1+h2);

    % ç”Ÿæˆç³»æ•°çŸ©é˜µAï¼Œä¿®æ”¹då‘é‡ï¼Œåˆ©ç”¨è¿½èµ¶æ³•æ±‚è§£M
    A = zeros(n-2, n-2); % åˆå§‹åŒ–ç³»æ•°çŸ©é˜µA
    for i = 1 : n-2 % å¾ªçŽ¯æž„é€ ç³»æ•°çŸ©é˜µA
        if (i > 1)
            A(i, i-1) = mu(i); % å¯¹è§’çº¿ä¸‹æ–¹
        end
        A(i, i) = 2; % å¯¹è§’çº¿
        if (i < n-2)
            A(i, i+1) = la(i); % å¯¹è§’çº¿ä¸Šæ–¹
        end
    end
    d(1) = d(1) - mu(1) * M1; % ä¿®æ”¹å‘é‡d
    d(n-2) = d(n-2) - la(n-2) * Mn; % ä¿®æ”¹å‘é‡d
    M = [M1; chase(A, d)'; Mn]; % åˆ©ç”¨è¿½èµ¶æ³•æ±‚è§£æ–¹ç¨‹ç»„,å¹¶è§£å‡ºå‘é‡M

    % æ±‚è§£ä¸‰æ¬¡æ ·æ¡æ’å€¼å‡½æ•°S(x)
    syms x % å®šä¹‰å‚æ•°x
    % æ ¹æ®ä¸Šè¿°å®šä¹‰,è®¡ç®—å‡ºä»¥ä¸‹6ä¸ªä¸­é—´å˜é‡
    x1 = a(2:n) - x;
    x2 = x - a(1:n-1);
    m1 = M(1:n-1);
    m2 = M(2:n);
    y1 = b(1:n-1);
    y2 = b(2:n);
    % æ±‚è§£ä¸‰æ¬¡æ ·æ¡æ’å€¼å‡½æ•°
    S = (x1.^3).*m1./(6*h)+(x2.^3).*m2./(6*h)+(y1-h.^2.*m1/6).*x1./h+(y2-h.^2.*m2/6).*x2./h;
    S = expand(S); % å±•å¼€æ’å€¼å¤šé¡¹å¼
    S = vpa(S, 5); % å°†åˆ†å¼ç³»æ•°è½¬åŒ–ä¸ºå°æ•°ç³»æ•°
end

% æ±‚è§£ä¸‰å¯¹è§’æ–¹ç¨‹ç»„çš„è¿½èµ¶æ³•
function x = chase(A, d) % Aä¸ºç³»æ•°çŸ©é˜µ,dä¸ºæ–¹ç¨‹ç»„å³ä¾§åˆ—å‘é‡
    [n, ~] = size(A);
    % é¢„åˆ†é…å†…å­˜,æé«˜è¿ç®—é€Ÿåº¦
    u = zeros(n, 1);
    l = zeros(n, 1);
    y = zeros(n, 1);
    % å‚è€ƒè¯¾æœ¬ç¬¬36é¢ä»£ç 
    u(1) = A(1, 1);
    y(1) = d(1);
    for i = 2 : n
        l(i) = A(i, i-1) / u(i-1);
        u(i) = A(i, i) - l(i) * A(i-1, i);
        y(i) = d(i) - l(i) * y(i-1);
    end
    x(n) = y(n) / u(n);
    for i = n-1 : -1 : 1
        x(i) = (y(i) - A(i, i+1) * x(i+1)) / u(i);
    end
end
```
