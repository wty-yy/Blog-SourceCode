---
title: CF1567 - Codeforces Round 742 (Div. 2)
hide: false
math: true
category:
  - coding
  - cf
tags:
  - æ„é€ 
  - æ¨¡æ‹Ÿ
  - è´ªå¿ƒ
  - çº¿æ®µæ ‘
abbrlink: 29690
date: 2021-09-07 15:34:45
index_img:
banner_img:
---

link: [Codeforces Round #742 (Div. 2)](https://codeforces.com/contest/1567)

## C - Carrying Conundrum

### é¢˜æ„

Aliceç»™å‡ºä¸€ç§ç‰¹æ®Šçš„åŠ æ³•è§„åˆ™ï¼Œæ¯ä¸€ä½è¿›ä½åä¼šè¿›ä½åˆ°æ›´é«˜çš„ä¸€ä½ä¸Šï¼Œç°åœ¨ç»™å‡ºä¸€ä¸ªæ•° $n$ï¼Œæ±‚æœ‰å¤šå°‘å¯¹æ•° $(a, b)$ ä½¿å…¶é€šè¿‡AliceåŠ æ³•ç›¸åŠ èƒ½å¾—åˆ° $n$ã€‚

æ•°æ®èŒƒå›´ï¼š$2\leqslant n \leqslant 10^9$ã€‚

### æ€è·¯

è€ƒè™‘å°† $n$ æ‹†åˆ†æˆå¥‡å¶åˆ†å¼€çœ‹ï¼Œå› ä¸ºå¥‡æ•°ä½çš„æ•°å­—è¿›ä½åªä¼šè¿›ä½åˆ°å¥‡æ•°ä½ä¸Šï¼Œå¶æ•°ä½åŒç†ï¼Œæ‰€ä»¥ä»–ä»¬äº’ä¸å½±å“ã€‚

æ¯”å¦‚ $12345$ï¼Œæ‹†åˆ†ä¸º $135$ å’Œ $24$ï¼Œé‚£ä¹ˆè¿™æ ·æ‹†åˆ†åï¼Œå†æ‰¾ä¸¤ä¸ªæ•°é€šè¿‡æ­£å¸¸åŠ æ³•å¾—åˆ°ä»–ä»¬ï¼Œæœ€åå†å°†ä»–ä»¬åˆå¹¶å³å¯ã€‚

æ¯”å¦‚ $135 = 90 + 45$ï¼Œ$24=20+4$ï¼Œé‚£ä¹ˆé€šè¿‡AliceåŠ æ³• $12345$ æ˜¯ $2900$ å’Œ $445$ çš„å’Œã€‚

äºæ˜¯é—®é¢˜è½¬æ¢ä¸º $n$ åœ¨æ­£å¸¸åŠ æ³•ä¸‹æœ‰å¤šå°‘ç§åˆ†è§£ï¼Œ$n+0,n-1+1,\cdots,1+n-1,0+n$
ä¸€å…± $n+1$ ç§ã€‚

æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ $(135+1)\cdot(24+1) - 2$=(å¥‡æ•°ä½æ•°+1)(å¶æ•°ä½æ•°+1)-2ï¼Œå‡äºŒåŸå› æ˜¯ä¼šæœ‰ä¸¤å¯¹ $(0,0)$ éœ€è¦å‡å»ã€‚

å¤æ‚åº¦ $O(\log_{10}n)$ã€‚

{% spoiler ç‚¹å‡»æ˜¾/éšä»£ç  %}
```c++
#include <bits/stdc++.h>
#define db double
#define ll long long
#define int ll
#define vi vector<int>
#define vii vector<vi >
#define pii pair<int, int>
#define vp vector<pii >
#define vip vector<vp >
#define mkp make_pair
#define pb push_back
#define Case(x) cout << "Case #" << x << ": "
using namespace std;
const int INF = 0x3f3f3f3f;
const int P = 998244353;
signed main(){
#ifdef _DEBUG
//	FILE *file = freopen("out", "w", stdout);
#endif
	ios::sync_with_stdio(0);
	cin.tie(0);
	int T;
	cin >> T;
	while (T--) {
		int n;
		cin >> n;
		string s;
		s = to_string(n);
		int a = 0, b = 0;
		for (int i = 0; i < s.size(); i += 2) a = a * 10 + s[i] - '0';
		for (int i = 1; i < s.size(); i += 2) b = b * 10 + s[i] - '0';
		cout << (a + 1) * (b + 1) - 2 << '\n';
	}
	return 0;
}
```
{% endspoiler %}

## D - Expression Evaluation Error

### é¢˜æ„

ç»™å‡º $n$ ä¸ªæ•°åœ¨10è¿›åˆ¶ä¸‹çš„å’Œä¸º $s$ï¼Œæ±‚ä»–ä»¬æœ€å°åœ¨11è¿›åˆ¶ä¸‹å’Œçš„æœ€å°å€¼ã€‚

æ•°æ®èŒƒå›´ï¼š$1\leqslant s\leqslant 10^9,1\leqslant n\leqslant \min(100,s)$ã€‚

### æ€è·¯

è¿™é“é¢˜ä¸»è¦æ˜¯è¦ææ¸…æ¥šï¼Œä¸ºä»€ä¹ˆ11è¿›åˆ¶ä¸‹å’Œæ•°ä¼šå˜å°ï¼Œæˆ‘ä»¬è®°11è¿›åˆ¶ä¸‹çš„10ä¸ºå­—æ¯Aã€‚

å¦‚æœæˆ‘ä»¬å°† $1000$ æ‹†æˆä¸¤ç§ï¼š$900+100, 990+10$ï¼Œé‚£ä¹ˆç¬¬ä¸€ç§ï¼š$900+100=A00$ï¼Œç¬¬äºŒç§ï¼š$990+10=9A0$ï¼Œé€šè¿‡ä»é«˜åˆ°ä½ä½ç½®ä¸Šæ•°å­—å¤§å°æ¯”è¾ƒï¼Œå®¹æ˜“çœ‹å‡º $1000 > A00 > 9A0$ï¼Œå…·ä½“åŸå› å°±æ˜¯11è¿›åˆ¶ä¸‹å¦‚æœå‘ç”Ÿè¿›ä½ï¼Œå°±ä¼šå¯¼è‡´æ•°å­—å‡å°1ï¼Œä»è€Œæ€»å’Œä¸‹é™ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½ä¸è¿›ä½ã€‚

å¦‚æœä¸è¿›ä½å‘¢ï¼Ÿå¯ä»¥è€ƒè™‘å°† $s$ æ¯ä¸€ä½å°½å¯èƒ½å¹³é“ºåˆ° $n$ ä½ä¸Šé¢ï¼Œæ¯”å¦‚ $s=354$ï¼Œ$n=5$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆé“º $300$ æ‹†åˆ†ä¸ºä¸‰ä¸ª $100$ï¼Œé¡ºç€æ”¾åˆ° $n$ ä¸ªä½å­ä¸Š

- $\{100, 100, 100, 0, 0\}$

å†æ‹† $50$ æ‹†æˆ5ä¸ª $10$ï¼Œæ¥ç€ä¸Šæ¬¡ç»“æŸçš„ä½ç½®ç»§ç»­æ”¾ï¼Œæ”¾æ»¡äº†å°±ä»å¤´å¼€å§‹ç»§ç»­æ”¾ï¼š

- å…ˆæ”¾2ä¸ªï¼š$\{100, 100, 100, 10, 10\}$ æ”¾æ»¡äº†ï¼Œä»å¤´æ¥ç€å†æ”¾3ä¸ªï¼š$\{110,110,110,10,10\}$

å†æ‹† $4$ æ‹†æˆ4ä¸ª $1$ï¼š

- æ¥ç€æ”¾4ä¸ªï¼š$\{111,111,110,11,11\}$

è¿™æ ·å°±å®Œæˆé¢˜æ„äº†ã€‚

ä½†å¦‚æœé‡åˆ°äº†ï¼Œè¿™æ ·ä¸€æ¬¡æ”¾ä¸æ»¡çš„æƒ…å†µæ¯”å¦‚ $110 3$ï¼Œæ‹†æˆæœ€åæ˜¯ $\{100,10,0\}$ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‹†ä½ï¼š

å°†10æ‹†æˆ9å’Œ1ï¼Œæˆ–100æ‹†æˆ90å’Œ10ï¼Œå¯ä»¥å‘ç° $90+10+10=100$ï¼Œè€Œ $100+9+1=1A0$ï¼Œåè€…æ›´å¤§ï¼Œè¿™æé†’æˆ‘ä»¬è¦ä»ä½ä½å¼€å§‹æ‹†ã€‚

æ‰€ä»¥æœ€åå¾—åˆ°çš„æ•°ç»„å°±æ˜¯ $\{100,9,1\}$ã€‚

æ–¹æ³•ä¸»è¦å°±æ˜¯æ‰¾åˆ°å½“å‰æœ€å°çš„10çš„å€æ•°ï¼Œæ‹†åˆ†æˆæ¯”ä»–å°10å€çš„10ä¸ªæ•°ï¼Œç”¨è´ªå¿ƒçš„æ€æƒ³ï¼ŒæŠŠåé¢çš„0éƒ½è¡¥å…¨å³å¯ã€‚

å¦‚æœä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤10çš„å€æ•°å’Œä½ç½®ï¼Œä»¥æ•°å­—å¤§å°ä¸ºé”®å€¼ï¼Œä¾¿å¯é™ä½æ—¶é—´å¤æ‚åº¦ã€‚

æ—¶é—´å¤æ‚åº¦ $O(10\log_{10}s+n\log n)$ã€‚

{% spoiler ç‚¹å‡»æ˜¾/éšä»£ç  %}
```c++
#include <bits/stdc++.h>
#define db double
#define ll long long
#define int ll
#define vi vector<int>
#define vii vector<vi >
#define pii pair<int, int>
#define vp vector<pii >
#define vip vector<vp >
#define mkp make_pair
#define pb push_back
#define Case(x) cout << "Case #" << x << ": "
using namespace std;
const int INF = 0x3f3f3f3f;
const int P = 1e9+7;
int ksm(int a, int b) {int ret = 1; while (b) {if (b & 1) ret = (ret * a) % P; a = a * a % P; b >>= 1;} return ret;}
signed main(){
#ifdef _DEBUG
	//FILE *file = freopen("out", "w", stdout);
#endif
	ios::sync_with_stdio(0);
	cin.tie(0);
	int T;
	cin >> T;
	while (T--) {
		priority_queue<pii, vp, greater<pii>> q;
		int n;
		string s;
		cin >> s >> n;
		vi ans(n);
		int p = 0, base = ksm(10, s.size() - 1);
		for (int i = 0; i < s.size(); i++, base /= 10) {
			for (int j = 0; j < s[i] - '0'; j++) {
				ans[p] += base;
				if (base != 1) q.push({base, p});
				p = (p + 1) % n;
			}
		}
		while (p < n && ans[p] == 0) {
			int x = q.top().second;
			q.pop();
			int base = ans[x] / 10;
			for (; p < n && ans[x] > base; p++) {
				ans[x] -= base;
				ans[p] += base;
				if (ans[p] != 1) q.push({ans[p], p});
			}
			if (ans[x] != 1) q.push({ans[x], x});
		}
		for (auto i : ans) cout << i << ' ';
		cout << '\n';
	}
	return 0;
}
```
{% endspoiler %}

## E - Non-Decreasing Dilemma 

### é¢˜æ„

ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ï¼Œ$a_1,a_2,\ldots,a_n$ï¼Œå’Œ $q$ æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®æœ‰ä¸¤ç§æ“ä½œï¼š

- $1\ x\ y$ï¼šæ“ä½œ1ï¼Œå°† $a_x$ å˜ä¸º $y$ã€‚

- $2\ l\ r$ï¼šæ“ä½œ2ï¼Œæ±‚åŒºé—´ $[l,r]$ ä¸­éé™åºåˆ—ï¼ˆä¿æŒè¿ç»­ï¼‰çš„ä¸ªæ•°ã€‚

å¯¹äºæ¯æ¬¡æ“ä½œ2è¾“å‡ºä½ çš„ç­”æ¡ˆã€‚

æ•°æ®èŒƒå›´ï¼š$1\leqslant n, q\leqslant 2\times 10^5, 1\leqslant a_i\leqslant 10^9$ã€‚

### æ€è·¯

ç”±äºä¸€ä¸ªé•¿åº¦ä¸º $n$ éé™åºåˆ—å¯ä»¥æ‹†åˆ†æˆ $\frac{n(n+1)}{2}$ ä¸ªéé™åºåˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªåŒºé—´å†…çš„æœ€é•¿éé™åºåˆ—æ®µçš„ä¸ªæ•°å’Œé•¿åº¦å³å¯ã€‚

å¯ä»¥é€šè¿‡çº¿æ®µæ ‘æ¥å®ç°ï¼Œåªéœ€è¦ç»´æŠ¤ä¸‹åˆ—4ä¸ªå‚æ•°ï¼š

- ä»å·¦ç«¯ç‚¹å¼€å§‹çš„æœ€é•¿éé™åºåˆ—çš„é•¿åº¦ï¼ˆæ•´å‹ï¼‰

- ä»å³ç«¯ç‚¹ç»“æŸçš„æœ€é•¿éé™åºåˆ—çš„é•¿åº¦ï¼ˆæ•´å‹ï¼‰

- æ˜¯å¦ä¸€æ•´æ®µæ˜¯ä¸€ä¸ªéé™åºåˆ—ï¼ˆå¸ƒå°”å‹ï¼‰

- é™¤å»åŒ…å«å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹çš„æœ€é•¿éé™åºåˆ—ï¼Œä¸­é—´æ®µéé™åºåˆ—ä¸ªæ•°ï¼ˆæ³¨æ„ä¸æ˜¯æœ€é•¿ï¼Œä¹Ÿå°±æ˜¯æ‹†åˆ†åçš„ï¼‰ï¼ˆæ•´å‹ï¼‰

ç½®äº $merge$ æ“ä½œæœ‰ç‚¹å¤æ‚ï¼Œä½†åªè¦ç»†å¿ƒè®¨è®ºï¼Œå…¶å®å¹¶ä¸éš¾å®ç°ï¼Œæ³¨æ„åˆ†ç±»çš„æƒ…å†µï¼ˆæˆ‘åˆ†äº†8ç§ğŸ˜‚ï¼‰ã€‚

æ€»å¤æ‚åº¦ï¼š$\mathcal{O}(q\log n)$ã€‚

{% spoiler ç‚¹å‡»æ˜¾/éšä»£ç  %}
```c++
#include <bits/stdc++.h>
#define db double
#define ll long long
#define int ll
#define vi vector<int>
#define vii vector<vi >
#define pii pair<int, int>
#define vp vector<pii >
#define vip vector<vp >
#define mkp make_pair
#define pb push_back
#define Case(x) cout << "Case #" << x << ": "
#define ls (p<<1)
#define rs (p<<1|1)
using namespace std;
const int INF = 0x3f3f3f3f;
const int P = 998244353;
const int N = 2e5 + 10;
int a[N];
struct SEG {
	struct Node {
		int l, r, lmx, rmx, tot;
		bool fg;
	}t[N<<2];
	void calc(Node &p, Node &l, Node &r) {
		p.lmx = l.lmx;
		p.rmx = r.rmx;
		int mid = (p.l + p.r) >> 1, tmp = l.rmx + r.lmx;
		p.fg = 0;
		if (l.fg && r.fg) {
			if (a[mid] <= a[mid+1]) {
				p.lmx = p.rmx = l.lmx + r.rmx;
				p.fg = 1;
			}
			p.tot = 0;
		} else if (l.fg) {
			if (a[mid] <= a[mid+1]) {
				p.lmx += r.lmx;
				p.tot = r.tot;
			} else {
				p.tot = r.tot + (r.lmx + 1) * r.lmx / 2;
			}
		} else if (r.fg) {
			if (a[mid] <= a[mid+1]) {
				p.rmx += l.rmx;
				p.tot = l.tot;
			} else {
				p.tot = l.tot + (l.rmx + 1) * l.rmx / 2;
			}
		} else {
			if (a[mid] <= a[mid+1]) p.tot = (tmp + 1) * tmp / 2;
			else p.tot = (l.rmx + 1) * l.rmx / 2 + (r.lmx + 1) * r.lmx / 2;
			p.tot += l.tot + r.tot;
		}
	}
	void pushup(int p) {
		calc(t[p], t[ls], t[rs]);
	}
	void build(int p, int l, int r) {
		t[p].l = l, t[p].r = r;
		if (l == r) {
			t[p].lmx = t[p].rmx = t[p].tot = 1;
			t[p].fg = 1;
			cin >> a[l];
			return;
		}
		int mid = (l + r) >> 1;
		build(ls, l, mid);
		build(rs, mid+1, r);
		pushup(p);
	}
	void update(int p, int x, int k) {
		if (t[p].l > x || t[p].r < x) return;
		if (t[p].l == x && t[p].r == x) {
			a[x] = k;
			return;
		}
		update(ls, x, k);
		update(rs, x, k);
		pushup(p);
	}
	Node query(int p, int l, int r) {
		if (t[p].l == l && t[p].r == r) return t[p];
		int mid = (t[p].l + t[p].r) >> 1;
		if (r <= mid) return query(ls, l, r);
		else if (l > mid) return query(rs, l, r);
		else {
			Node L = query(ls, l, mid), R = query(rs, mid+1, r);
			Node now = t[p];
			calc(now, L, R);
			return now;
		}
	}
	void solve() {
		int n, m;
		cin >> n >> m;
		build(1, 1, n);
		while (m--) {
			int opt, l, r;
			cin >> opt >> l >> r;
			if (opt == 1) {
				update(1, l, r);
			} else {
				Node ans = query(1, l, r);
				if (ans.fg) cout << (ans.lmx + 1) * ans.lmx / 2 << '\n';
				else cout << (ans.lmx + 1) * ans.lmx / 2 + (ans.rmx + 1) * ans.rmx / 2 + ans.tot << '\n';
			}
		}
	}
}seg;
signed main(){
#ifdef _DEBUG
//	FILE *file = freopen("out", "w", stdout);
#endif
	ios::sync_with_stdio(0);
	cin.tie(0);
	seg.solve();
	return 0;
}
```
{% endspoiler %}
